<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìµœì  ê°€ê²© ì „ëµ ì‹œë®¬ë ˆì´í„°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter í°íŠ¸ ì‚¬ìš© -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #1f2937; color: #f9fafb; }
        .card { background-color: #374151; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1); }
        .log-entry { padding: 8px 12px; margin-bottom: 4px; border-radius: 6px; }
        .bg-green-600-light { background-color: #10b981; }
        .bg-red-600-light { background-color: #ef4444; }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen flex items-start justify-center">

    <div id="app" class="w-full max-w-4xl space-y-6">
        <h1 class="text-3xl font-bold text-center text-teal-400">ğŸ’° ìµœì  ê°€ê²© ì „ëµ ì‹œë®¬ë ˆì´í„° ğŸ’°</h1>
        <p class="text-center text-gray-300">ë‹¹ì‹ ì€ CEOì…ë‹ˆë‹¤. ê°€ê²©ì„ ì¡°ì •í•˜ë©° ì´ìˆ˜ì…ì„ ìµœëŒ€í™”í•˜ì„¸ìš”! (ì´ 10íšŒ ì‹œë„ ê°€ëŠ¥)</p>

        <!-- í˜„ì¬ ì‹œì¥ ìƒí™© ìš”ì•½ -->
        <div id="current-status" class="card p-6 grid grid-cols-3 gap-4 text-center">
            <div class="border-r border-gray-600">
                <p class="text-sm font-semibold text-gray-400">í˜„ì¬ ê°€ê²© (P)</p>
                <p id="current-price" class="text-2xl font-bold text-indigo-400 mt-1">â‚©</p>
            </div>
            <div class="border-r border-gray-600">
                <p class="text-sm font-semibold text-gray-400">íŒë§¤ëŸ‰ (Q)</p>
                <p id="current-quantity" class="text-2xl font-bold text-indigo-400 mt-1">ê°œ</p>
            </div>
            <div>
                <p class="text-sm font-semibold text-gray-400">ì´ìˆ˜ì… (TR = P Ã— Q)</p>
                <p id="current-revenue" class="text-2xl font-bold text-yellow-400 mt-1">â‚©</p>
            </div>
        </div>

        <!-- ê°€ê²© ê²°ì • ë° ì‹œë®¬ë ˆì´ì…˜ ì˜ì—­ -->
        <div id="price-control" class="card p-6 space-y-4">
            <h2 class="text-xl font-semibold text-gray-200">ê°€ê²© ê²°ì • (ë‚¨ì€ ì‹œë„: <span id="attempts-left">10</span>íšŒ)</h2>
            <div class="flex flex-col sm:flex-row gap-4">
                <input type="number" id="new-price" placeholder="ìƒˆë¡œìš´ ê°€ê²©ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: 20)"
                       class="w-full sm:w-2/3 p-3 text-lg rounded-lg bg-gray-600 text-white placeholder-gray-400 focus:ring-teal-500 focus:border-teal-500 border-transparent transition duration-150"
                       min="1" max="100">
                <button id="set-price-btn"
                        class="w-full sm:w-1/3 p-3 text-lg font-bold rounded-lg bg-teal-500 hover:bg-teal-600 transition duration-150 disabled:opacity-50 disabled:cursor-not-allowed">
                    ê°€ê²© ê²°ì • ë° ì‹œë®¬ë ˆì´ì…˜
                </button>
            </div>
            <p id="message-box" class="text-center text-lg font-medium h-6"></p>
        </div>

        <!-- ì‹œë®¬ë ˆì´ì…˜ ê¸°ë¡ (ë¡œê·¸) -->
        <div class="card p-6">
            <h2 class="text-xl font-semibold text-gray-200 mb-3">ì‹œë®¬ë ˆì´ì…˜ ê¸°ë¡ ë° ë¶„ì„</h2>
            <div id="simulation-log" class="space-y-2 max-h-60 overflow-y-auto">
                <!-- Log entries will be inserted here -->
                <p class="text-gray-400 text-center">ì‹œë®¬ë ˆì´ì…˜ì„ ì‹œì‘í•´ì£¼ì„¸ìš”.</p>
            </div>
        </div>

        <!-- ê²°ê³¼ ëª¨ë‹¬ (ìˆ¨ê¹€) -->
        <div id="result-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50">
            <div class="card p-8 w-full max-w-md text-center space-y-4">
                <h3 id="result-title" class="text-3xl font-bold text-teal-400">ê²Œì„ ì¢…ë£Œ!</h3>
                <p id="result-message" class="text-lg text-gray-200"></p>
                <p id="result-optimal" class="text-lg font-semibold text-yellow-300"></p>
                <button onclick="resetGame()" class="p-3 w-full bg-indigo-500 rounded-lg font-bold hover:bg-indigo-600 transition">
                    ìƒˆ ê²Œì„ ì‹œì‘
                </button>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ìƒìˆ˜ ë° ë³€ìˆ˜
        const MAX_ATTEMPTS = 10;
        // â­ ìˆ˜ì •: ìµœì  ê°€ê²©ìœ¼ë¡œ ì¸ì •ë˜ëŠ” í—ˆìš© ì˜¤ì°¨ ë²”ìœ„ (0ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ ì •í™•í•œ ê°’ë§Œ ì¸ì •)
        const OPTIMAL_THRESHOLD = 0; 
        
        let attempts = MAX_ATTEMPTS;

        // ìˆ¨ê²¨ì§„ ìˆ˜ìš” í•¨ìˆ˜ (Q = a - bP)
        // â­ ìˆ˜ì •: ìƒˆë¡œìš´ ìˆ˜ìš” í•¨ìˆ˜ Q = 800 - 5P (ìµœì  ê°€ê²© P=80)
        const DEMAND_A = 800;
        const DEMAND_B = 5;
        const OPTIMAL_PRICE = DEMAND_A / (2 * DEMAND_B); // 800 / 10 = 80

        // ìƒíƒœ ë³€ìˆ˜
        // â­ ìˆ˜ì •: ìƒˆë¡œìš´ ì‹œì‘ ìƒíƒœ P=40, Q=600, TR=24000
        let previousPrice = 40;
        let previousQuantity = 600;
        let previousRevenue = 24000;
        let isGameOver = false;

        // DOM ìš”ì†Œ
        const currentPriceEl = document.getElementById('current-price');
        const currentQuantityEl = document.getElementById('current-quantity');
        const currentRevenueEl = document.getElementById('current-revenue');
        const attemptsLeftEl = document.getElementById('attempts-left');
        const newPriceInput = document.getElementById('new-price');
        const setPriceBtn = document.getElementById('set-price-btn');
        const simulationLogEl = document.getElementById('simulation-log');
        const messageBox = document.getElementById('message-box');
        const resultModal = document.getElementById('result-modal');
        const resultTitle = document.getElementById('result-title');
        const resultMessage = document.getElementById('result-message');
        const resultOptimal = document.getElementById('result-optimal');

        // ------------------
        // 1. í•µì‹¬ ê³„ì‚° ë¡œì§
        // ------------------

        /**
         * ì£¼ì–´ì§„ ê°€ê²©ì— ëŒ€í•œ ìˆ˜ìš”ëŸ‰ì„ ê³„ì‚°í•©ë‹ˆë‹¤.
         * @param {number} P ê°€ê²©
         * @returns {number} ìˆ˜ìš”ëŸ‰
         */
        function calculateQuantity(P) {
            let Q = DEMAND_A - DEMAND_B * P;
            return Math.max(0, Q); // ìˆ˜ìš”ëŸ‰ì€ 0 ë¯¸ë§Œì´ ë  ìˆ˜ ì—†ìŒ
        }

        /**
         * ì´ìˆ˜ì…ì„ ê³„ì‚°í•©ë‹ˆë‹¤.
         * @param {number} P ê°€ê²©
         * @param {number} Q ìˆ˜ìš”ëŸ‰
         * @returns {number} ì´ìˆ˜ì…
         */
        function calculateRevenue(P, Q) {
            return P * Q;
        }

        /**
         * í˜¸ íƒ„ë ¥ì„± (Arc Elasticity)ì„ ê³„ì‚°í•©ë‹ˆë‹¤.
         * P1, Q1ì—ì„œ P2, Q2ë¡œ ë³€í•  ë•Œì˜ íƒ„ë ¥ì„±
         */
        function calculateArcElasticity(P1, Q1, P2, Q2) {
            const deltaQ = Q2 - Q1;
            const deltaP = P2 - P1;
            const avgQ = (Q1 + Q2) / 2;
            const avgP = (P1 + P2) / 2;

            if (avgP === 0 || avgQ === 0 || deltaP === 0) return 999; // ê°€ê²© ë³€í™”ê°€ ì—†ê±°ë‚˜ 0ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ê²½ìš° ì˜ˆì™¸ ì²˜ë¦¬
            
            const elasticity = Math.abs((deltaQ / avgQ) / (deltaP / avgP));
            return elasticity;
        }

        // ------------------
        // 2. UI ì—…ë°ì´íŠ¸
        // ------------------

        function updateStatusDisplay() {
            currentPriceEl.textContent = `â‚©${previousPrice.toLocaleString()}`;
            currentQuantityEl.textContent = `${previousQuantity.toLocaleString()}ê°œ`;
            currentRevenueEl.textContent = `â‚©${previousRevenue.toLocaleString()}`;
            attemptsLeftEl.textContent = attempts;
            newPriceInput.value = ''; // ì…ë ¥ì°½ ì´ˆê¸°í™”
        }

        function addLogEntry(P_new, Q_new, TR_new) {
            const TR_diff = TR_new - previousRevenue;
            let logClass = 'bg-gray-700';
            let revenueTrend = 'ìœ ì§€';
            let trendIcon = 'â†”ï¸';
            let elasticityFeedback = '';

            if (TR_diff > 0) {
                logClass = 'bg-green-700/50 border-l-4 border-green-400';
                revenueTrend = 'ì¦ê°€';
                trendIcon = 'â¬†ï¸';
            } else if (TR_diff < 0) {
                logClass = 'bg-red-700/50 border-l-4 border-red-400';
                revenueTrend = 'ê°ì†Œ';
                trendIcon = 'â¬‡ï¸';
            } else {
                logClass = 'bg-blue-700/50 border-l-4 border-blue-400';
            }

            // íƒ„ë ¥ì„± ê°œë… í”¼ë“œë°± (ê°„ë‹¨í•œ ê³ êµ ìˆ˜ì¤€ í•´ì„)
            const priceChange = P_new - previousPrice;
            const elasticity = calculateArcElasticity(previousPrice, previousQuantity, P_new, Q_new);
            
            let ed_value = elasticity.toFixed(2);
            let ed_type = "ì¸¡ì • ë¶ˆê°€";

            if (priceChange !== 0 && previousQuantity > 0 && Q_new > 0) {
                 if (ed_value > 1.05) { // ì•½ê°„ì˜ ì—¬ìœ ë¥¼ ì¤Œ (1.05)
                    ed_type = "íƒ„ë ¥ì  (> 1)";
                } else if (ed_value < 0.95) { // ì•½ê°„ì˜ ì—¬ìœ ë¥¼ ì¤Œ (0.95)
                    ed_type = "ë¹„íƒ„ë ¥ì  (< 1)";
                } else {
                    ed_type = "ë‹¨ìœ„ íƒ„ë ¥ì  (â‰ˆ 1)";
                }
            } else if (previousQuantity === 0 && Q_new === 0 && priceChange !== 0) {
                ed_type = "ì™„ì „ ë¹„íƒ„ë ¥ì  (0)";
                ed_value = '0';
            }
            
            // í”¼ë“œë°± ë©”ì‹œì§€
            if (TR_diff > 0) {
                // ê°€ê²© ìƒìŠ¹(P_new > previousPrice) && ë¹„íƒ„ë ¥ì (ed_value < 1) -> TR ì¦ê°€ (ì˜³ì€ ì „ëµ)
                // ê°€ê²© í•˜ë½(P_new < previousPrice) && íƒ„ë ¥ì (ed_value > 1) -> TR ì¦ê°€ (ì˜³ì€ ì „ëµ)
                if ((priceChange > 0 && ed_value < 1) || (priceChange < 0 && ed_value > 1)) {
                    elasticityFeedback = `<span class="text-green-300">ğŸ‘ ì´ ì „ëµì€ íƒ„ë ¥ì„± ì›ë¦¬ì— ë§ìŠµë‹ˆë‹¤!</span>`;
                }
            } else if (TR_diff < 0) {
                // ê°€ê²© ìƒìŠ¹(P_new > previousPrice) && íƒ„ë ¥ì (ed_value > 1) -> TR ê°ì†Œ (ì˜ëª»ëœ ì „ëµ)
                // ê°€ê²© í•˜ë½(P_new < previousPrice) && ë¹„íƒ„ë ¥ì (ed_value < 1) -> TR ê°ì†Œ (ì˜ëª»ëœ ì „ëµ)
                 if ((priceChange > 0 && ed_value > 1) || (priceChange < 0 && ed_value < 1)) {
                    elasticityFeedback = `<span class="text-red-300">ğŸ‘ ì´ ì „ëµì€ íƒ„ë ¥ì„± ì›ë¦¬ì— ì—­í–‰í•©ë‹ˆë‹¤!</span>`;
                }
            }


            const logHtml = `
                <div class="${logClass} text-sm">
                    <p class="font-bold">ì‹œë„ ${MAX_ATTEMPTS - attempts} (${trendIcon} ì´ìˆ˜ì… ${revenueTrend} â‚©${Math.abs(TR_diff).toLocaleString()})</p>
                    <ul class="list-disc ml-4 text-gray-300">
                        <li>ê°€ê²© ë³€í™”: â‚©${previousPrice} â†’ â‚©${P_new}</li>
                        <li>ìˆ˜ìš”ëŸ‰ ë³€í™”: ${previousQuantity}ê°œ â†’ ${Q_new}ê°œ</li>
                        <li>ê³„ì‚°ëœ íƒ„ë ¥ì„± (ì ˆëŒ“ê°’): |${ed_value}| (${ed_type})</li>
                        <li>${elasticityFeedback}</li>
                    </ul>
                </div>
            `;
            
            // ìƒˆë¡œìš´ ë¡œê·¸ë¥¼ ë§¨ ìœ„ì— ì¶”ê°€
            simulationLogEl.insertAdjacentHTML('afterbegin', logHtml);
            // ì´ˆê¸° ì•ˆë‚´ ë©”ì‹œì§€ ì œê±°
            if (simulationLogEl.querySelector('.text-gray-400')) {
                simulationLogEl.removeChild(simulationLogEl.querySelector('.text-gray-400'));
            }
        }

        function showResult(title, message, optimalInfo) {
            resultTitle.textContent = title;
            resultMessage.innerHTML = message;
            resultOptimal.textContent = optimalInfo;
            resultModal.classList.remove('hidden');
            setPriceBtn.disabled = true;
            isGameOver = true;
        }

        // ------------------
        // 3. ê²Œì„ ë¡œì§
        // ------------------

        function handleSetPrice() {
            if (isGameOver) return;

            const P_new = parseInt(newPriceInput.value);
            const threshold = OPTIMAL_THRESHOLD; // ìµœì  ê°€ê²©ê³¼ì˜ ì°¨ì´ í—ˆìš© ë²”ìœ„

            if (isNaN(P_new) || P_new <= 0) {
                messageBox.textContent = 'ìœ íš¨í•œ ê°€ê²©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!';
                messageBox.className = 'text-center text-lg font-medium h-6 text-red-400';
                return;
            }
            if (P_new === previousPrice) {
                messageBox.textContent = 'ì´ì „ê³¼ ë‹¤ë¥¸ ê°€ê²©ì„ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤!';
                messageBox.className = 'text-center text-lg font-medium h-6 text-red-400';
                return;
            }
            
            messageBox.textContent = ''; // ë©”ì‹œì§€ ì´ˆê¸°í™”
            messageBox.className = 'text-center text-lg font-medium h-6 text-white';

            const Q_new = calculateQuantity(P_new);
            const TR_new = calculateRevenue(P_new, Q_new);
            
            // ë¡œê·¸ ê¸°ë¡
            addLogEntry(P_new, Q_new, TR_new);

            // ìƒíƒœ ì—…ë°ì´íŠ¸
            attempts--;
            previousPrice = P_new;
            previousQuantity = Q_new;
            previousRevenue = TR_new;

            updateStatusDisplay();
            
            // â­ ìƒˆë¡œìš´ ê¸°ëŠ¥: ìµœì  ê°€ê²©ì„ ì°¾ì•˜ëŠ”ì§€ ì¦‰ì‹œ í™•ì¸í•˜ê³  ê²Œì„ ì¢…ë£Œ
            // OPTIMAL_THRESHOLDê°€ 0ì´ë¯€ë¡œ, P_newê°€ OPTIMAL_PRICEì™€ ì •í™•íˆ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.
            if (Math.abs(P_new - OPTIMAL_PRICE) <= threshold) {
                checkWinCondition(P_new, true); // ì¦‰ì‹œ ì¢…ë£Œ í”Œë˜ê·¸ true
                return; // í•¨ìˆ˜ ì¢…ë£Œ
            }

            // ë‚¨ì€ ì‹œë„ê°€ ì—†ì„ ê²½ìš° ê²Œì„ ì¢…ë£Œ
            if (attempts <= 0) {
                checkWinCondition(P_new, false); // ì¦‰ì‹œ ì¢…ë£Œê°€ ì•„ë‹˜
            }
        }

        function checkWinCondition(finalPrice, instantWin = false) {
            const threshold = OPTIMAL_THRESHOLD; 
            // â­ ìˆ˜ì •: ìµœëŒ€ ì´ìˆ˜ì… â‚©32,000
            const maxRevenue = 32000;
            
            let title = 'ì•„ì‰½ìŠµë‹ˆë‹¤!';
            let message = 'ì£¼ì–´ì§„ íšŸìˆ˜ ì•ˆì— ì´ìˆ˜ì…ì„ ìµœëŒ€í™”í•˜ëŠ” ìµœì  ê°€ê²©ì„ ì°¾ì§€ ëª»í–ˆì–´ìš”.';
            let optimalInfo = `ìµœëŒ€ ì´ìˆ˜ì…ì€ â‚©${maxRevenue.toLocaleString()}ì¼ ë•Œ, ìµœì  ê°€ê²©ì€ â‚©${OPTIMAL_PRICE}ì…ë‹ˆë‹¤.`;

            // ì´ìˆ˜ì… ê·¹ëŒ€í™” ì§€ì ì— ë„ë‹¬í–ˆëŠ”ì§€ í™•ì¸ (P=80)
            if (Math.abs(finalPrice - OPTIMAL_PRICE) <= threshold) {
                let attemptsUsed = MAX_ATTEMPTS - attempts;
                title = 'ğŸ† ì„±ê³µ! ìµœì  ê°€ê²© ë°œê²¬! ğŸ†';
                message = `ë‹¨ ${attemptsUsed}íšŒ ë§Œì— ì´ìˆ˜ì… â‚©${previousRevenue.toLocaleString()} (ìµœëŒ€ì¹˜ì— ê·¼ì ‘)ë¥¼ ë‹¬ì„±í•˜ëŠ” ìµœì ì˜ ê°€ê²©ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤!`;
            } else if (previousRevenue === maxRevenue) {
                let attemptsUsed = MAX_ATTEMPTS - attempts;
                title = 'ğŸ‰ ì™„ë²½ ì„±ê³µ! ì´ìˆ˜ì… ìµœëŒ€í™”! ğŸ‰';
                message = `ë‹¨ ${attemptsUsed}íšŒ ë§Œì— ì´ìˆ˜ì…ì„ â‚©${maxRevenue.toLocaleString()}ë¡œ ê·¹ëŒ€í™”í•˜ëŠ” ê°€ê²©ì„ ì •í™•íˆ ì°¾ì•˜ìŠµë‹ˆë‹¤.`;
            } else {
                 message += ` ìµœì¢… ì´ìˆ˜ì…ì€ â‚©${previousRevenue.toLocaleString()}ì…ë‹ˆë‹¤.`;
                 if(instantWin) { // ì˜¤ë¥˜ë¡œ ì¸í•´ instantWinì´ trueì¸ë° ì‹¤íŒ¨í•œ ê²½ìš°
                    title = 'ì•„ì‰½ìŠµë‹ˆë‹¤!';
                    message = 'ìµœì  ê°€ê²© ê·¼ì²˜ë¡œ ê°”ì§€ë§Œ, ì´ìˆ˜ì…ì„ ê·¹ëŒ€í™”í•˜ì§€ëŠ” ëª»í–ˆìŠµë‹ˆë‹¤.';
                 }
            }
            
            // í•™ìŠµ í”¼ë“œë°± ì¶”ê°€
            message += `<br><br><strong>[í•µì‹¬ ì›ë¦¬]</strong> ì´ìˆ˜ì…ì„ ìµœëŒ€í™”í•˜ëŠ” ì§€ì ì€ ìˆ˜ìš”ì˜ ê°€ê²© íƒ„ë ¥ì„±(|Ed|)ì´ 1ì¸ ì§€ì (ë‹¨ìœ„ íƒ„ë ¥ì )ì…ë‹ˆë‹¤. ì´ ì§€ì ì„ ì°¾ê¸° ìœ„í•´ ê°€ê²© ì¡°ì • ì‹œ ì´ìˆ˜ì…ì˜ ë³€í™”ë¥¼ ê´€ì°°í•´ì•¼ í•©ë‹ˆë‹¤.`;

            showResult(title, message, optimalInfo);
        }
        
        function resetGame() {
            // â­ ìˆ˜ì •: ìƒˆë¡œìš´ ì´ˆê¸° ìƒíƒœë¡œ ë³µì›
            attempts = MAX_ATTEMPTS;
            previousPrice = 40;
            previousQuantity = 600;
            previousRevenue = 24000;
            isGameOver = false;

            // UI ì´ˆê¸°í™”
            simulationLogEl.innerHTML = '<p class="text-gray-400 text-center">ì‹œë®¬ë ˆì´ì…˜ì„ ì‹œì‘í•´ì£¼ì„¸ìš”.</p>';
            resultModal.classList.add('hidden');
            setPriceBtn.disabled = false;
            messageBox.textContent = '';
            messageBox.className = 'text-center text-lg font-medium h-6 text-white';
            
            updateStatusDisplay();
        }

        // ------------------
        // 4. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë° ì´ˆê¸°í™”
        // ------------------

        setPriceBtn.addEventListener('click', handleSetPrice);
        newPriceInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                handleSetPrice();
            }
        });

        // ì•± ì´ˆê¸°í™”
        window.onload = function() {
            resetGame(); // ì´ˆê¸° ìƒíƒœ ì„¤ì • ë° ë””ìŠ¤í”Œë ˆì´ ì—…ë°ì´íŠ¸
        }
    </script>
</body>
</html>
